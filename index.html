<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Teleco Project</title>
<style>
  :root{
    --bg:#0f172a;          /* fondo */
    --panel:#111827;       /* tarjetas */
    --accent:#22c55e;      /* verde */
    --accent-2:#60a5fa;    /* azul */
    --text:#e5e7eb;        /* texto */
    --muted:#94a3b8;       /* texto suave */
    --danger:#ef4444;      /* rojo error */
    --ok:#10b981;          /* verde ok */
    --radius:18px;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif; 
    background: radial-gradient(1200px 600px at 50% -10%, #1f2937, var(--bg));
    color:var(--text);
  }
  header{
    position:sticky; top:0; z-index:10;
    background:rgba(17,24,39,.75);
    backdrop-filter: blur(8px);
    border-bottom:1px solid rgba(255,255,255,.06);
  }
  .wrap{max-width:900px;margin:0 auto;padding:18px}
  .title{
    display:flex; align-items:center; gap:12px; font-weight:800; letter-spacing:.5px;
    font-size:28px;
  }
  .title .dot{width:12px;height:12px;background:conic-gradient(from 0deg, var(--accent), var(--accent-2));
    border-radius:50%; box-shadow:0 0 24px rgba(96,165,250,.6)}
  .grid{
    display:grid; gap:16px; margin-top:18px;
    grid-template-columns: repeat( auto-fill, minmax(220px, 1fr) );
  }
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.08);
    border-radius:var(--radius); padding:16px;
    box-shadow:0 8px 24px rgba(0,0,0,.25);
    transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease;
  }
  .card:hover{ transform:translateY(-2px); border-color: rgba(96,165,250,.45); box-shadow:0 12px 30px rgba(37,99,235,.20)}
  .btn{
    width:100%; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.12);
    background:linear-gradient(180deg, rgba(34,197,94,.25), rgba(34,197,94,.18));
    color:white; font-weight:700; letter-spacing:.2px;
    transition: transform .08s ease, filter .2s ease, background .2s ease;
  }
  .btn:hover{ filter:brightness(1.1) }
  .btn:active{ transform:scale(.98) }
  .btn-secondary{
    background:linear-gradient(180deg, rgba(96,165,250,.25), rgba(96,165,250,.18));
  }
  .btn-ghost{
    background:transparent; border:1px dashed rgba(255,255,255,.18); color:var(--muted)
  }
  .section{ display:none; animation:fade .2s ease }
  .section.active{ display:block }
  @keyframes fade{ from{opacity:0; transform: translateY(4px)} to{opacity:1; transform:none}}
  .h2{font-size:20px;font-weight:800;margin:8px 0 10px}
  .muted{color:var(--muted); font-size:13px}
  .row{display:flex; gap:10px; flex-wrap:wrap}
  .field{flex:1; min-width:120px}
  input, select{
    width:100%; padding:12px 10px; background:#0b1020; color:var(--text);
    border:1px solid rgba(255,255,255,.12); border-radius:12px;
    outline:none; transition:border-color .15s ease, box-shadow .15s ease;
    text-align:center;
  }
  input:focus, select:focus{border-color:#60a5fa; box-shadow:0 0 0 4px rgba(96,165,250,.15)}
  .pill{
    display:inline-flex; gap:8px; align-items:center;
    padding:6px 10px; font-size:12px; border-radius:999px;
    background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08)
  }
  .tag{ font-size:11px; color:var(--muted)}
  .error{ color:var(--danger); font-weight:700; margin-top:6px}
  .ok{ color:var(--ok); font-weight:700; margin-top:6px}
  .result{
    margin-top:12px; padding:12px; border-radius:12px;
    background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08);
    text-align:left; line-height:1.5
  }
  .ip-slots{ display:flex; gap:10px; justify-content:center; margin:8px 0}
  .oct{ width:72px }
  .chip{
    display:inline-block; padding:4px 8px; border-radius:999px; font-size:12px;
    background:rgba(96,165,250,.15); border:1px solid rgba(96,165,250,.35); margin-right:6px
  }
  .footer{ text-align:center; color:var(--muted); font-size:12px; padding:22px 0 36px }
  .back{ margin-top:10px }
  .divider{ height:1px; background: linear-gradient(90deg, transparent, rgba(255,255,255,.12), transparent); margin:14px 0 }
  .list{margin:0; padding-left:16px}
  .list li{ margin:4px 0}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="title"><span class="dot"></span> Teleco Project</div>
  </div>
</header>

<main class="wrap">
  <!-- MENU -->
  <section id="menu" class="section active">
    <div class="grid">
      <div class="card">
        <div class="h2">Conversores</div>
        <div class="muted">Bases y IP rápido</div>
        <div class="divider"></div>
        <button class="btn" onclick="openSection('conv')">Abrir</button>
      </div>
      <div class="card">
        <div class="h2">VLSM</div>
        <div class="muted">Asigna subredes por requerimientos</div>
        <div class="divider"></div>
        <button class="btn btn-secondary" onclick="openSection('vlsm')">Abrir</button>
      </div>
      <div class="card">
        <div class="h2">Tablas rápidas</div>
        <div class="muted">CIDR, máscaras y rangos privados</div>
        <div class="divider"></div>
        <button class="btn btn-ghost" onclick="openSection('tablas')">Abrir</button>
      </div>
    </div>
  </section>

  <!-- CONVERSORES -->
  <section id="conv" class="section">
    <div class="card">
      <div class="h2">Conversor de Bases</div>
      <div class="muted">Selecciona origen y destino. Verás “n (de) → (a) = resultado”.</div>
      <div class="divider"></div>
      <div class="row">
        <div class="field">
          <label class="tag">Número</label>
          <input id="conv-num" placeholder="Ej: 101101, 45, 2A" />
        </div>
        <div class="field">
          <label class="tag">De</label>
          <select id="conv-from">
            <option value="bin">Binario</option>
            <option value="dec" selected>Decimal</option>
            <option value="hex">Hexadecimal</option>
          </select>
        </div>
        <div class="field">
          <label class="tag">A</label>
          <select id="conv-to">
            <option value="bin">Binario</option>
            <option value="dec">Decimal</option>
            <option value="hex" selected>Hexadecimal</option>
          </select>
        </div>
      </div>
      <button class="btn" onclick="convertBases()">Convertir</button>
      <div id="conv-msg" class="error" style="display:none"></div>
      <div id="conv-res" class="result" style="display:none"></div>
      <div class="back">
        <button class="btn btn-ghost" onclick="openSection('menu')">⬅ Volver</button>
      </div>
    </div>

    <div class="grid" style="margin-top:16px">
      <div class="card">
        <div class="h2">IP Binario → Decimal</div>
        <div class="muted">Ingresa 4 octetos binarios (8 bits c/u). Solo 0 y 1.</div>
        <div class="ip-slots">
          <input class="oct" id="b1" maxlength="8" placeholder="00000000" inputmode="numeric" />
          <span class="pill">.</span>
          <input class="oct" id="b2" maxlength="8" placeholder="00000000" inputmode="numeric" />
          <span class="pill">.</span>
          <input class="oct" id="b3" maxlength="8" placeholder="00000000" inputmode="numeric" />
          <span class="pill">.</span>
          <input class="oct" id="b4" maxlength="8" placeholder="00000000" inputmode="numeric" />
        </div>
        <button class="btn btn-secondary" onclick="ipBinToDec()">Convertir</button>
        <div id="bin2dec-msg" class="error" style="display:none"></div>
        <div id="bin2dec-res" class="result" style="display:none"></div>
      </div>

      <div class="card">
        <div class="h2">IP Decimal → Binario</div>
        <div class="muted">Cada octeto máx. 3 dígitos y valor 0–255.</div>
        <div class="ip-slots">
          <input class="oct" id="d1" maxlength="3" placeholder="192" inputmode="numeric" />
          <span class="pill">.</span>
          <input class="oct" id="d2" maxlength="3" placeholder="168" inputmode="numeric" />
          <span class="pill">.</span>
          <input class="oct" id="d3" maxlength="3" placeholder="1" inputmode="numeric" />
          <span class="pill">.</span>
          <input class="oct" id="d4" maxlength="3" placeholder="10" inputmode="numeric" />
        </div>
        <button class="btn btn-secondary" onclick="ipDecToBin()">Convertir</button>
        <div id="dec2bin-msg" class="error" style="display:none"></div>
        <div id="dec2bin-res" class="result" style="display:none"></div>
      </div>
    </div>
  </section>

  <!-- VLSM -->
  <section id="vlsm" class="section">
    <div class="card">
      <div class="h2">Calculadora VLSM</div>
      <div class="muted">Define red base y requerimientos de hosts. Se asigna de mayor a menor.</div>
      <div class="divider"></div>

      <div class="row">
        <div class="field">
          <label class="tag">Red base (IPv4)</label>
          <input id="vlsm-base" placeholder="Ej: 10.0.0.0" />
        </div>
        <div class="field">
          <label class="tag">Prefijo</label>
          <input id="vlsm-prefix" placeholder="/8, /16, /24" />
        </div>
      </div>

      <div class="divider"></div>
      <div class="h2">Requerimientos de Subred</div>
      <div id="req-list"></div>
      <div class="row" style="margin-top:8px">
        <div class="field"><input id="req-name" placeholder="Nombre (ej: Sede A)" /></div>
        <div class="field"><input id="req-hosts" inputmode="numeric" placeholder="Hosts (ej: 50)" /></div>
        <div class="field" style="min-width:140px">
          <button class="btn" onclick="addRequirement()">+ Agregar</button>
        </div>
      </div>

      <div class="divider"></div>
      <button class="btn btn-secondary" onclick="runVLSM()">Calcular VLSM</button>
      <div id="vlsm-msg" class="error" style="display:none"></div>
      <div id="vlsm-res" class="result" style="display:none"></div>

      <div class="back">
        <button class="btn btn-ghost" onclick="openSection('menu')">⬅ Volver</button>
      </div>
    </div>
  </section>

  <!-- TABLAS RÁPIDAS -->
  <section id="tablas" class="section">
    <div class="card">
      <div class="h2">Tablas rápidas</div>
      <div class="divider"></div>
      <ul class="list">
        <li><span class="chip">Privadas</span> 10.0.0.0/8 — 172.16.0.0/12 — 192.168.0.0/16</li>
        <li><span class="chip">Máscaras comunes</span> /24 = 255.255.255.0 — /26 = 255.255.255.192 — /30 = 255.255.255.252</li>
        <li><span class="chip">Potencias de 2</span> 2, 4, 8, 16, 32, 64, 128, 256…</li>
      </ul>
      <div class="back">
        <button class="btn btn-ghost" onclick="openSection('menu')">⬅ Volver</button>
      </div>
    </div>
  </section>

  <div class="footer">© 2025 • Teleco Project</div>
</main>

<script>
  /* Navegación simple */
  function openSection(id){
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    window.scrollTo({top:0, behavior:'smooth'});
  }

  /* Conversor de bases */
  function convertBases(){
    const numStr = document.getElementById('conv-num').value.trim();
    const from = document.getElementById('conv-from').value;
    const to = document.getElementById('conv-to').value;
    const msg = document.getElementById('conv-msg');
    const res = document.getElementById('conv-res');
    msg.style.display='none'; res.style.display='none';

    if(!numStr){ showErr(msg, 'Ingresa un número.'); return; }

    // Validaciones por base
    const valid = {
      bin: /^[01]+$/i,
      dec: /^\d+$/i,
      hex: /^[0-9a-f]+$/i
    };
    if(!valid[from].test(numStr)){ showErr(msg, `Formato inválido para ${labelBase(from)}.`); return; }

    let value;
    try{
      const radix = from==='bin'?2:from==='dec'?10:16;
      value = parseInt(numStr, radix);
      if(Number.isNaN(value)) throw 'NaN';
    }catch(e){ showErr(msg, 'No se pudo interpretar el número.'); return; }

    let out;
    try{
      if(to==='bin') out = value.toString(2);
      else if(to==='dec') out = value.toString(10);
      else out = value.toString(16).toUpperCase();
    }catch(e){ showErr(msg, 'Error al convertir.'); return; }

    res.innerHTML = `<b>${escapeHtml(numStr)}</b> (${labelBase(from)}) → <b>${labelBase(to)}</b> = <b>${out}</b>`;
    res.style.display='block';
  }
  function labelBase(b){ return b==='bin'?'Binario':b==='dec'?'Decimal':'Hexadecimal'; }

  /* IP Binario → Decimal */
  ['b1','b2','b3','b4'].forEach(id=>{
    const el = ()=>document.getElementById(id);
    // sólo 0/1
    el().addEventListener('input', (e)=>{
      e.target.value = e.target.value.replace(/[^01]/g,'').slice(0,8);
    });
  });
  function ipBinToDec(){
    const msg = document.getElementById('bin2dec-msg');
    const res = document.getElementById('bin2dec-res');
    msg.style.display='none'; res.style.display='none';

    const vals = ['b1','b2','b3','b4'].map(id=>document.getElementById(id).value.trim());
    if(vals.some(v => v.length!==8)){ showErr(msg,'Cada octeto debe tener exactamente 8 bits.'); return; }
    if(vals.some(v => /[^01]/.test(v))){ showErr(msg,'Solo se permiten 0 y 1.'); return; }

    const decs = vals.map(v=> parseInt(v,2));
    const dotted = decs.join('.');
    res.innerHTML = `<div><span class="chip">${vals.join('.')}</span> → <b>${dotted}</b></div>`;
    res.style.display='block';
  }

  /* IP Decimal → Binario */
  ['d1','d2','d3','d4'].forEach(id=>{
    const el = ()=>document.getElementById(id);
    el().addEventListener('input', (e)=>{
      // solo dígitos, máx 3 caracteres
      e.target.value = e.target.value.replace(/\D/g,'').slice(0,3);
    });
  });
  function ipDecToBin(){
    const msg = document.getElementById('dec2bin-msg');
    const res = document.getElementById('dec2bin-res');
    msg.style.display='none'; res.style.display='none';

    const raw = ['d1','d2','d3','d4'].map(id=>document.getElementById(id).value.trim());
    if(raw.some(v=>v==='')){ showErr(msg,'Completa los 4 octetos.'); return; }

    const nums = raw.map(v=>Number(v));
    if(nums.some(n=>Number.isNaN(n))){ showErr(msg,'Solo se permiten números.'); return; }
    const invalid = nums.find(n => n<0 || n>255);
    if(invalid !== undefined){
      showErr(msg, `Octeto fuera de rango: ${invalid}. Máximo permitido 255.`); return;
    }
    const bins = nums.map(n=> n.toString(2).padStart(8,'0'));
    res.innerHTML = `<div><span class="chip">${nums.join('.')}</span> → <b>${bins.join('.')}</b></div>`;
    res.style.display='block';
  }

  /* VLSM */
  const reqs = [];
  function addRequirement(){
    const name = document.getElementById('req-name').value.trim() || `Subred ${reqs.length+1}`;
    const hostsStr = document.getElementById('req-hosts').value.trim();
    const msg = document.getElementById('vlsm-msg');
    msg.style.display='none';

    if(!hostsStr){ showErr(msg,'Ingresa cantidad de hosts.'); return; }
    const hosts = Number(hostsStr);
    if(!Number.isInteger(hosts) || hosts<=0){ showErr(msg,'Hosts debe ser un entero positivo.'); return; }

    reqs.push({name, hosts});
    document.getElementById('req-name').value='';
    document.getElementById('req-hosts').value='';
    renderReqs();
  }
  function renderReqs(){
    const cont = document.getElementById('req-list');
    cont.innerHTML = '';
    reqs.forEach((r, i)=>{
      const div = document.createElement('div');
      div.className = 'row';
      div.style.margin='6px 0';
      div.innerHTML = `
        <div class="pill" style="flex:1;justify-content:space-between">
          <span><b>${escapeHtml(r.name)}</b> • ${r.hosts} hosts</span>
          <button class="btn btn-ghost" style="padding:4px 8px" onclick="delReq(${i})">Quitar</button>
        </div>
      `;
      cont.appendChild(div);
    });
  }
  function delReq(i){ reqs.splice(i,1); renderReqs(); }

  function runVLSM(){
    const base = document.getElementById('vlsm-base').value.trim();
    const prefixStr = document.getElementById('vlsm-prefix').value.trim().replace('/','');
    const msg = document.getElementById('vlsm-msg');
    const out = document.getElementById('vlsm-res');
    msg.style.display='none'; out.style.display='none';

    // Validar IP base
    const ipParts = base.split('.');
    if(ipParts.length!==4 || ipParts.some(p=>p==='' || /\D/.test(p) || Number(p)<0 || Number(p)>255)){
      showErr(msg,'IP base inválida. Usa formato x.x.x.x con octetos 0–255.'); return;
    }
    // Validar prefijo
    const pref = Number(prefixStr);
    if(!Number.isInteger(pref) || pref<0 || pref>32){
      showErr(msg,'Prefijo inválido. Ej: /24'); return;
    }
    if(reqs.length===0){ showErr(msg,'Agrega al menos un requerimiento de hosts.'); return; }

    // Calcular VLSM
    try{
      const baseNum = ipToNum(ipParts.map(Number));
      const blockSize = 2**(32-pref); // tamaño total
      const networkStart = (baseNum >>> 0) & (~0 >>> 0) & ( (baseNum>>>0) - ((baseNum - (baseNum & (~(blockSize-1))))>>>0) >=0 ? (baseNum & (~(blockSize-1))) : (baseNum & (~(blockSize-1))) );
      // Ordenar reqs
      const sorted = [...reqs].sort((a,b)=>b.hosts - a.hosts);

      let cursor = networkStart>>>0;
      const endOfSpace = (networkStart + blockSize - 1)>>>0;
      const rows = [];

      for(const r of sorted){
        const needed = r.hosts + 2; // red+broadcast
        const hostBits = Math.ceil(Math.log2(needed));
        const subPref = 32 - hostBits;
        const subBlock = 2**hostBits; // tamaño en direcciones
        // Alinear cursor al tamaño del bloque
        const aligned = align(cursor, subBlock);
        const netStart = aligned;
        const netEnd = (aligned + subBlock - 1)>>>0;

        if(netEnd > endOfSpace){
          showErr(msg, `No caben todas las subredes. Falló en "${r.name}" (${r.hosts} hosts).`); 
          return;
        }

        rows.push({
          name:r.name,
          prefix: subPref,
          mask: prefixToMask(subPref),
          network: numToIp(netStart),
          broadcast: numToIp(netEnd),
          firstHost: subPref===31? numToIp(netStart): numToIp(netStart+1),
          lastHost: subPref===31? numToIp(netEnd): numToIp(netEnd-1),
          usable: subPref>=31 ? (subPref===31?2:1) : (subBlock-2)
        });

        cursor = (netEnd + 1)>>>0;
      }

      // Render
      out.innerHTML = rows.map(r=>`
        <div style="margin-bottom:10px; padding-bottom:10px; border-bottom:1px dashed rgba(255,255,255,.1)">
          <div><b>${escapeHtml(r.name)}</b> — /${r.prefix} (${r.mask}) <span class="tag">Usables: ${r.usable}</span></div>
          <div>Red: <b>${r.network}/${r.prefix}</b></div>
          <div>Rango hosts: <b>${r.firstHost}</b> — <b>${r.lastHost}</b></div>
          <div>Broadcast: <b>${r.broadcast}</b></div>
        </div>
      `).join('') + (rows.length? '':'(Sin resultados)');
      out.style.display='block';

    }catch(e){
      showErr(msg,'Ocurrió un error al calcular VLSM.');
      console.error(e);
    }
  }

  /* Utilidades IP */
  function ipToNum(parts){
    return ((parts[0]<<24)>>>0) + ((parts[1]<<16)>>>0) + ((parts[2]<<8)>>>0) + (parts[3]>>>0);
  }
  function numToIp(num){
    return `${(num>>>24)&255}.${(num>>>16)&255}.${(num>>>8)&255}.${num&255}`;
  }
  function prefixToMask(p){
    let mask = 0;
    for(let i=0;i<p;i++) mask = (mask<<1) | 1;
    mask = mask << (32-p);
    return numToIp(mask>>>0);
  }
  function align(value, block){
    const m = block - 1;
    return (value + m) & ~m;
  }

  /* Helpers UI */
  function showErr(el, text){ el.textContent = text; el.style.display='block'; el.className='error'; }
  function escapeHtml(str){ return str.replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }
</script>
</body>
</html> 